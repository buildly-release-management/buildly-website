<!-- Social Media Sharing Component with Enhanced Emoji Support -->
<div id="social-sharing" class="bg-gray-50 border border-gray-200 rounded-lg p-6 my-8">
    <h3 class="text-lg font-semibold text-buildly-dark mb-4 flex items-center">
        <span class="emoji mr-2">ðŸ”—</span>
        Share this article
    </h3>
    <div class="flex flex-wrap gap-3">
        <!-- Twitter/X Share Button -->
        <button id="share-twitter" class="inline-flex items-center px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
            Share on X
        </button>

        <!-- LinkedIn Share Button -->
        <button id="share-linkedin" class="inline-flex items-center px-4 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
            Share on LinkedIn
        </button>

        <!-- BlueSky Share Button -->
        <button id="share-bluesky" class="inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L8.5 8.5c-1.5 2.5-4 4-6.5 4.5 2.5.5 5-2 6.5-4.5L12 2z"/>
                <path d="M12 2l3.5 6.5c1.5 2.5 4 4 6.5 4.5-2.5.5-5-2-6.5-4.5L12 2z"/>
                <path d="M12 15l-3.5 6.5c-1.5 2.5-4 4-6.5 4.5 2.5-.5 5-2 6.5-4.5L12 15z"/>
                <path d="M12 15l3.5 6.5c1.5 2.5 4 4 6.5 4.5-2.5-.5-5-2-6.5-4.5L12 15z"/>
            </svg>
            Share on BlueSky
        </button>

        <!-- Mastodon Share Button -->
        <button id="share-mastodon" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792.01 11.813.01h-.03c-3.98 0-4.835.232-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/>
            </svg>
            Share on Mastodon
        </button>

        <!-- Copy Link Button -->
        <button id="copy-link" class="inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
            </svg>
            Copy Link
        </button>
    </div>
    
    <!-- Success message -->
    <div id="share-success" class="mt-4 p-3 bg-green-100 border border-green-200 rounded-lg text-green-800 hidden">
        <div class="flex items-center">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            <span id="share-success-text">Link copied to clipboard!</span>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get article information
    const articleTitle = document.querySelector('h1')?.textContent || document.title;
    const articleUrl = window.location.href;
    const articleDescription = document.querySelector('meta[name="description"]')?.content || '';
    
    // Load social accounts configuration
    let socialAccounts = {};
    
    async function loadSocialAccounts() {
        try {
            const response = await fetch('/api/social-accounts');
            if (response.ok) {
                socialAccounts = await response.json();
            }
        } catch (error) {
            console.log('Could not load social accounts, using defaults');
        }
    }
    
    // Initialize social accounts
    loadSocialAccounts();
    
    // Twitter/X share handler
    document.getElementById('share-twitter').addEventListener('click', function() {
        const template = socialAccounts.twitter?.template || 'ðŸ“š {title}\n\n{url}\n\n#AI #ProductDevelopment #BuildlyIO via @buildlyio';
        const shareText = template
            .replace('{title}', articleTitle)
            .replace('{url}', articleUrl)
            .replace('{description}', articleDescription);
        
        const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}`;
        window.open(twitterUrl, '_blank', 'width=600,height=400');
    });
    
    // LinkedIn share handler
    document.getElementById('share-linkedin').addEventListener('click', function() {
        const template = socialAccounts.linkedin?.template || 'Check out this article: {title} {url}';
        const shareText = template
            .replace('{title}', articleTitle)
            .replace('{url}', articleUrl)
            .replace('{description}', articleDescription);
        
        const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(articleUrl)}&title=${encodeURIComponent(articleTitle)}&summary=${encodeURIComponent(shareText)}`;
        window.open(linkedinUrl, '_blank', 'width=600,height=400');
    });
    
    // BlueSky share handler
    document.getElementById('share-bluesky').addEventListener('click', function() {
        const template = socialAccounts.bluesky?.template || 'Check out this article: {title} {url}';
        const shareText = template
            .replace('{title}', articleTitle)
            .replace('{url}', articleUrl)
            .replace('{description}', articleDescription);
        
        // BlueSky compose URL (if available, otherwise copy to clipboard)
        if (socialAccounts.bluesky?.handle) {
            const blueskyUrl = `https://bsky.app/intent/compose?text=${encodeURIComponent(shareText)}`;
            window.open(blueskyUrl, '_blank', 'width=600,height=400');
        } else {
            copyToClipboard(shareText, 'BlueSky share text copied to clipboard!');
        }
    });
    
    // Mastodon share handler
    document.getElementById('share-mastodon').addEventListener('click', function() {
        const template = socialAccounts.mastodon?.template || 'Check out this article: {title} {url}';
        const shareText = template
            .replace('{title}', articleTitle)
            .replace('{url}', articleUrl)
            .replace('{description}', articleDescription);
        
        const instance = socialAccounts.mastodon?.instance || 'mastodon.social';
        const mastodonUrl = `https://${instance}/share?text=${encodeURIComponent(shareText)}`;
        window.open(mastodonUrl, '_blank', 'width=600,height=400');
    });
    
    // Copy link handler
    document.getElementById('copy-link').addEventListener('click', function() {
        copyToClipboard(articleUrl, 'Link copied to clipboard!');
    });
    
    // Copy to clipboard function
    function copyToClipboard(text, message) {
        if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(function() {
                showSuccessMessage(message);
            }).catch(function() {
                fallbackCopyTextToClipboard(text, message);
            });
        } else {
            fallbackCopyTextToClipboard(text, message);
        }
    }
    
    // Fallback copy function
    function fallbackCopyTextToClipboard(text, message) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.top = "0";
        textArea.style.left = "0";
        textArea.style.position = "fixed";
        
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            showSuccessMessage(message);
        } catch (err) {
            console.error('Fallback: Oops, unable to copy', err);
        }
        
        document.body.removeChild(textArea);
    }
    
    // Show success message
    function showSuccessMessage(message) {
        const successDiv = document.getElementById('share-success');
        const successText = document.getElementById('share-success-text');
        
        successText.textContent = message;
        successDiv.classList.remove('hidden');
        
        setTimeout(() => {
            successDiv.classList.add('hidden');
        }, 3000);
    }
});
</script>